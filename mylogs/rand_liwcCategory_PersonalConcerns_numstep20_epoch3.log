2018-05-09 11:31:05.620331: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-05-09 11:31:05.620363: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-05-09 11:31:05.620371: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-05-09 11:31:05.620377: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-05-09 11:31:05.620381: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-05-09 11:31:13.877714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID f823:00:00.0
Total memory: 11.17GiB
Free memory: 11.10GiB
2018-05-09 11:31:13.877759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2018-05-09 11:31:13.877767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2018-05-09 11:31:13.877782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: f823:00:00.0)
2018-05-09 11:31:43.575683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: f823:00:00.0)
当前的日期和时间是 2018-05-09 11:31:05.620118
keep_prob:0.5
word_to_id.len:7203
isRandomIni:True
isLiwcCategory:True
isEmojiCoOccur:False
isLiwcCount:False
id of <eos> :  7033
id of <unk> :  7032
6631784
TrainInput epoch_size：20724
rand ini:(7203, 400)
typeOfEmb:<class 'int'>
embedding size:73
dict中没有的词：472

(7203, 406)
830197
ValidInput epoch_size：2594
rand ini:(7203, 400)
typeOfEmb:<class 'int'>
embedding size:73
dict中没有的词：472

(7203, 406)
831242
TestInput epoch_size：41562
rand ini:(7203, 400)
typeOfEmb:<class 'int'>
embedding size:73
dict中没有的词：472

(7203, 406)
Epoch: 1 Learning rate: 0.200
step / (model.input.epoch_size // 10): 0.000 perplexity: 2726.142 speed: 2532 wps cost:  137
step / (model.input.epoch_size // 10): 0.100 perplexity: 138.836 speed: 4916 wps cost:  95
step / (model.input.epoch_size // 10): 0.200 perplexity: 103.630 speed: 4933 wps cost:  92
step / (model.input.epoch_size // 10): 0.300 perplexity: 89.386 speed: 4938 wps cost:  84
step / (model.input.epoch_size // 10): 0.400 perplexity: 81.339 speed: 4939 wps cost:  80
step / (model.input.epoch_size // 10): 0.500 perplexity: 76.100 speed: 4940 wps cost:  74
step / (model.input.epoch_size // 10): 0.600 perplexity: 72.244 speed: 4940 wps cost:  81
step / (model.input.epoch_size // 10): 0.700 perplexity: 69.296 speed: 4941 wps cost:  78
step / (model.input.epoch_size // 10): 0.800 perplexity: 67.020 speed: 4943 wps cost:  84
step / (model.input.epoch_size // 10): 0.900 perplexity: 65.231 speed: 4943 wps cost:  75
Epoch: 1 Train Perplexity: 63.717 train_allCount: 6631680 train_acc: ['0.3179', '0.4722', '0.5205'] rightCountTopK : [2108046, 3131426, 3452022]
words prediction total: 3894728
word top1 hit total: 1391690   accuracy: 0.3573266220388176
word top3 hit total: 1926190   accuracy: 0.4945634200899267
word top5 hit total: 2092812   accuracy: 0.5373448415396402
emoji prediction total: 178459
emoji top1 hit total: 2894   accuracy: 0.016216609977641922
emoji top3 hit total: 16919   accuracy: 0.09480608991420998
emoji top5 hit total: 33550   accuracy: 0.18799836376982948
same emoji prediction total: 603309
same emoji top1 hit total: 440854   accuracy: 0.7307267088672637
same emoji top3 hit total: 548876   accuracy: 0.9097759191392802
same emoji top5 hit total: 558115   accuracy: 0.9250897964393039
diff emoji prediction total: 163820
diff emoji top1 hit total: 6591   accuracy: 0.04023318276156757
diff emoji top3 hit total: 42009   accuracy: 0.25643389085581736
diff emoji top5 hit total: 61859   accuracy: 0.37760346722011967
all emoji prediction total: 945588
all emoji top1 hit total: 450339   recall: 0.4762528712293303
all emoji top3 hit total: 607804   recall: 0.6427788846728173
all emoji top5 hit total: 653524   recall: 0.6911297520696117
Epoch: 1 Valid Perplexity: 46.337 valid_allCount: 830080 valid_acc: ['0.3464', '0.5019', '0.5515'] rightCountTopK : [287557, 416615, 457783]
words prediction total: 487681
word top1 hit total: 190086   accuracy: 0.38977528343322787
word top3 hit total: 258500   accuracy: 0.5300596086376135
word top5 hit total: 280070   accuracy: 0.5742893407780906
emoji prediction total: 22515
emoji top1 hit total: 497   accuracy: 0.022074172773706418
emoji top3 hit total: 2667   accuracy: 0.118454363757495
emoji top5 hit total: 5172   accuracy: 0.22971352431712191
same emoji prediction total: 74300
same emoji top1 hit total: 64822   accuracy: 0.872436069986541
same emoji top3 hit total: 73049   accuracy: 0.9831628532974428
same emoji top5 hit total: 73345   accuracy: 0.9871467025572005
diff emoji prediction total: 21146
diff emoji top1 hit total: 631   accuracy: 0.029840158895299347
diff emoji top3 hit total: 6321   accuracy: 0.2989217818972855
diff emoji top5 hit total: 9457   accuracy: 0.44722406128818687
all emoji prediction total: 117961
all emoji top1 hit total: 65950   recall: 0.5590830867829197
all emoji top3 hit total: 82037   recall: 0.695458668542993
all emoji top5 hit total: 87974   recall: 0.7457888624206306
Epoch: 2 Learning rate: 0.200
step / (model.input.epoch_size // 10): 0.000 perplexity: 58.727 speed: 4870 wps cost:  88
step / (model.input.epoch_size // 10): 0.100 perplexity: 50.513 speed: 4943 wps cost:  85
step / (model.input.epoch_size // 10): 0.200 perplexity: 50.104 speed: 4945 wps cost:  68
step / (model.input.epoch_size // 10): 0.300 perplexity: 49.748 speed: 4944 wps cost:  81
step / (model.input.epoch_size // 10): 0.400 perplexity: 49.401 speed: 4945 wps cost:  72
step / (model.input.epoch_size // 10): 0.500 perplexity: 49.192 speed: 4946 wps cost:  79
step / (model.input.epoch_size // 10): 0.600 perplexity: 48.979 speed: 4946 wps cost:  79
step / (model.input.epoch_size // 10): 0.700 perplexity: 48.708 speed: 4947 wps cost:  78
step / (model.input.epoch_size // 10): 0.800 perplexity: 48.502 speed: 4946 wps cost:  70
step / (model.input.epoch_size // 10): 0.900 perplexity: 48.366 speed: 4946 wps cost:  79
Epoch: 2 Train Perplexity: 48.198 train_allCount: 6631680 train_acc: ['0.3390', '0.4969', '0.5462'] rightCountTopK : [2248461, 3295169, 3622421]
words prediction total: 3895271
word top1 hit total: 1477609   accuracy: 0.3793340694395846
word top3 hit total: 2033652   accuracy: 0.5220822890114706
word top5 hit total: 2206427   accuracy: 0.5664373544228374
emoji prediction total: 178353
emoji top1 hit total: 4013   accuracy: 0.022500322394352772
emoji top3 hit total: 20725   accuracy: 0.11620213845575908
emoji top5 hit total: 38436   accuracy: 0.21550520596793998
same emoji prediction total: 602772
same emoji top1 hit total: 488741   accuracy: 0.8108223341495624
same emoji top3 hit total: 592101   accuracy: 0.9822967888355796
same emoji top5 hit total: 596452   accuracy: 0.9895151068729138
diff emoji prediction total: 164004
diff emoji top1 hit total: 8398   accuracy: 0.0512060681446794
diff emoji top3 hit total: 47931   accuracy: 0.2922550669495866
diff emoji top5 hit total: 70654   accuracy: 0.43080656569351966
all emoji prediction total: 945129
all emoji top1 hit total: 501152   recall: 0.5302471937693162
all emoji top3 hit total: 660757   recall: 0.6991183214143255
all emoji top5 hit total: 705542   recall: 0.7465033873682851
Epoch: 2 Valid Perplexity: 42.686 valid_allCount: 830080 valid_acc: ['0.3527', '0.5088', '0.5600'] rightCountTopK : [292805, 422338, 464807]
words prediction total: 487805
word top1 hit total: 191622   accuracy: 0.3928250017937496
word top3 hit total: 261577   accuracy: 0.536232715941821
word top5 hit total: 284531   accuracy: 0.583288404177899
emoji prediction total: 22560
emoji top1 hit total: 498   accuracy: 0.022074468085106384
emoji top3 hit total: 2821   accuracy: 0.12504432624113476
emoji top5 hit total: 5140   accuracy: 0.22783687943262412
same emoji prediction total: 74070
same emoji top1 hit total: 65079   accuracy: 0.8786148238153099
same emoji top3 hit total: 73591   accuracy: 0.9935331443229377
same emoji top5 hit total: 73765   accuracy: 0.9958822735250439
diff emoji prediction total: 21101
diff emoji top1 hit total: 831   accuracy: 0.0393820198094877
diff emoji top3 hit total: 6574   accuracy: 0.3115492156769821
diff emoji top5 hit total: 9864   accuracy: 0.46746599687218615
all emoji prediction total: 117731
all emoji top1 hit total: 66408   recall: 0.5640655392377538
all emoji top3 hit total: 82986   recall: 0.7048780694974136
all emoji top5 hit total: 88769   recall: 0.7539985220545141
Epoch: 3 Learning rate: 0.200
step / (model.input.epoch_size // 10): 0.000 perplexity: 41.551 speed: 4587 wps cost:  67
step / (model.input.epoch_size // 10): 0.100 perplexity: 46.301 speed: 4940 wps cost:  76
step / (model.input.epoch_size // 10): 0.200 perplexity: 46.105 speed: 4943 wps cost:  71
step / (model.input.epoch_size // 10): 0.300 perplexity: 45.953 speed: 4943 wps cost:  75
step / (model.input.epoch_size // 10): 0.400 perplexity: 45.890 speed: 4944 wps cost:  71
step / (model.input.epoch_size // 10): 0.500 perplexity: 45.778 speed: 4945 wps cost:  80
step / (model.input.epoch_size // 10): 0.600 perplexity: 45.677 speed: 4946 wps cost:  82
step / (model.input.epoch_size // 10): 0.700 perplexity: 45.557 speed: 4947 wps cost:  82
step / (model.input.epoch_size // 10): 0.800 perplexity: 45.467 speed: 4947 wps cost:  76
step / (model.input.epoch_size // 10): 0.900 perplexity: 45.414 speed: 4946 wps cost:  79
Epoch: 3 Train Perplexity: 45.299 train_allCount: 6631680 train_acc: ['0.3441', '0.5017', '0.5515'] rightCountTopK : [2281809, 3327058, 3657094]
words prediction total: 3895496
word top1 hit total: 1499689   accuracy: 0.3849802438508472
word top3 hit total: 2057761   accuracy: 0.5282410763610077
word top5 hit total: 2233336   accuracy: 0.5733123586829507
emoji prediction total: 178304
emoji top1 hit total: 4371   accuracy: 0.02451431263460158
emoji top3 hit total: 21748   accuracy: 0.12197146446518306
emoji top5 hit total: 39788   accuracy: 0.22314698492462312
same emoji prediction total: 603596
same emoji top1 hit total: 497233   accuracy: 0.823784451851901
same emoji top3 hit total: 596769   accuracy: 0.9886894545358154
same emoji top5 hit total: 600127   accuracy: 0.9942527783484317
diff emoji prediction total: 163500
diff emoji top1 hit total: 9948   accuracy: 0.06084403669724771
diff emoji top3 hit total: 49287   accuracy: 0.30144954128440365
diff emoji top5 hit total: 72386   accuracy: 0.4427278287461774
all emoji prediction total: 945400
all emoji top1 hit total: 511552   recall: 0.5410958324518722
all emoji top3 hit total: 667804   recall: 0.7063719060715041
all emoji top5 hit total: 712301   recall: 0.7534387560820817
Epoch: 3 Valid Perplexity: 41.022 valid_allCount: 830080 valid_acc: ['0.3550', '0.5123', '0.5617'] rightCountTopK : [294711, 425224, 466287]
words prediction total: 487511
word top1 hit total: 195497   accuracy: 0.4010104387388182
word top3 hit total: 265321   accuracy: 0.5442359249329759
word top5 hit total: 287165   accuracy: 0.5890431190270579
emoji prediction total: 22540
emoji top1 hit total: 817   accuracy: 0.03624667258207631
emoji top3 hit total: 3365   accuracy: 0.14929015084294586
emoji top5 hit total: 5361   accuracy: 0.2378438331854481
same emoji prediction total: 74452
same emoji top1 hit total: 68214   accuracy: 0.9162144737549025
same emoji top3 hit total: 74064   accuracy: 0.9947885886208564
same emoji top5 hit total: 74198   accuracy: 0.9965884059528287
diff emoji prediction total: 21105
diff emoji top1 hit total: 1548   accuracy: 0.07334754797441365
diff emoji top3 hit total: 6974   accuracy: 0.3304430229803364
diff emoji top5 hit total: 10213   accuracy: 0.48391376451077944
all emoji prediction total: 118097
all emoji top1 hit total: 70579   recall: 0.5976358417233292
all emoji top3 hit total: 84403   recall: 0.7146921598347121
all emoji top5 hit total: 89772   recall: 0.7601547880132433
Test Perplexity: 40.216 test_allCount: 831240.000 test_acc: ['0.3576', '0.5144', '0.5650'] rightCountTopK : [297268, 427580, 469638]
words prediction total: 486178
word top1 hit total: 195213   accuracy: 0.40152577862428984
word top3 hit total: 265272   accuracy: 0.5456273216805367
word top5 hit total: 287372   accuracy: 0.5910839239949155
emoji prediction total: 22327
emoji top1 hit total: 727   accuracy: 0.03256147265642496
emoji top3 hit total: 3213   accuracy: 0.14390648094235678
emoji top5 hit total: 5299   accuracy: 0.23733596094414833
same emoji prediction total: 77584
same emoji top1 hit total: 71562   accuracy: 0.9223809032790266
same emoji top3 hit total: 77190   accuracy: 0.9949216333264591
same emoji top5 hit total: 77358   accuracy: 0.9970870282532481
diff emoji prediction total: 21360
diff emoji top1 hit total: 1337   accuracy: 0.06259363295880149
diff emoji top3 hit total: 6802   accuracy: 0.3184456928838951
diff emoji top5 hit total: 10273   accuracy: 0.4809456928838951
all emoji prediction total: 121271
all emoji top1 hit total: 73626   recall: 0.6071195916583519
all emoji top3 hit total: 87205   recall: 0.7190919510847605
all emoji top5 hit total: 92930   recall: 0.7663002696440204
top1_emoji_total: 116108   pred1_emoji_ratio: 0.19114032618376192
top3_emoji_total: 356664   pred3_emoji_ratio: 0.5871505262170158
goal_unk_total: 32658   goal_unk_ratio: 0.0537625380896174
top1_unk_total: 116108   pred1_unk_ratio: 0.06243322484685957
top3_unk_total: 356664   pred3_unk_ratio: 0.3549614864787003
Saving model to /home/pubsrv/data/guorui/data/Res/rand_liwcCategory_PersonalConcerns_numstep20_epoch3/0.
Finished!
当前的日期和时间是 2018-05-09 12:53:31.953874
